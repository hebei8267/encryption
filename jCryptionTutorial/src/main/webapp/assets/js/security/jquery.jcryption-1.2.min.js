function setMaxDigits(e){maxDigits=e;ZERO_ARRAY=new Array(maxDigits);for(var t=0;t<ZERO_ARRAY.length;t++)ZERO_ARRAY[t]=0;bigZero=new BigInt;bigOne=new BigInt;bigOne.digits[0]=1}function BigInt(e){if(typeof e=="boolean"&&e==true){this.digits=null}else{this.digits=ZERO_ARRAY.slice(0)}this.isNeg=false}function biFromDecimal(e){var t=e.charAt(0)=="-";var n=t?1:0;var r;while(n<e.length&&e.charAt(n)=="0")++n;if(n==e.length){r=new BigInt}else{var i=e.length-n;var s=i%dpl10;if(s==0)s=dpl10;r=biFromNumber(Number(e.substr(n,s)));n+=s;while(n<e.length){r=biAdd(biMultiply(r,biFromNumber(1e15)),biFromNumber(Number(e.substr(n,dpl10))));n+=dpl10}r.isNeg=t}return r}function biCopy(e){var t=new BigInt(true);t.digits=e.digits.slice(0);t.isNeg=e.isNeg;return t}function biFromNumber(e){var t=new BigInt;t.isNeg=e<0;e=Math.abs(e);var n=0;while(e>0){t.digits[n++]=e&maxDigitVal;e>>=biRadixBits}return t}function reverseStr(e){var t="";for(var n=e.length-1;n>-1;--n){t+=e.charAt(n)}return t}function biToString(e,t){var n=new BigInt;n.digits[0]=t;var r=biDivideModulo(e,n);var i=hexatrigesimalToChar[r[1].digits[0]];while(biCompare(r[0],bigZero)==1){r=biDivideModulo(r[0],n);digit=r[1].digits[0];i+=hexatrigesimalToChar[r[1].digits[0]]}return(e.isNeg?"-":"")+reverseStr(i)}function biToDecimal(e){var t=new BigInt;t.digits[0]=10;var n=biDivideModulo(e,t);var r=String(n[1].digits[0]);while(biCompare(n[0],bigZero)==1){n=biDivideModulo(n[0],t);r+=String(n[1].digits[0])}return(e.isNeg?"-":"")+reverseStr(r)}function digitToHex(e){var t=15;var n="";for(i=0;i<4;++i){n+=hexToChar[e&t];e>>>=4}return reverseStr(n)}function biToHex(e){var t="";var n=biHighIndex(e);for(var r=biHighIndex(e);r>-1;--r){t+=digitToHex(e.digits[r])}return t}function charToHex(e){var t=48;var n=t+9;var r=97;var i=r+25;var s=65;var o=65+25;var u;if(e>=t&&e<=n){u=e-t}else if(e>=s&&e<=o){u=10+e-s}else if(e>=r&&e<=i){u=10+e-r}else{u=0}return u}function hexToDigit(e){var t=0;var n=Math.min(e.length,4);for(var r=0;r<n;++r){t<<=4;t|=charToHex(e.charCodeAt(r))}return t}function biFromHex(e){var t=new BigInt;var n=e.length;for(var r=n,i=0;r>0;r-=4,++i){t.digits[i]=hexToDigit(e.substr(Math.max(r-4,0),Math.min(r,4)))}return t}function biFromString(e,t){var n=e.charAt(0)=="-";var r=n?1:0;var i=new BigInt;var s=new BigInt;s.digits[0]=1;for(var o=e.length-1;o>=r;o--){var u=e.charCodeAt(o);var a=charToHex(u);var f=biMultiplyDigit(s,a);i=biAdd(i,f);s=biMultiplyDigit(s,t)}i.isNeg=n;return i}function biDump(e){return(e.isNeg?"-":"")+e.digits.join(" ")}function biAdd(e,t){var n;if(e.isNeg!=t.isNeg){t.isNeg=!t.isNeg;n=biSubtract(e,t);t.isNeg=!t.isNeg}else{n=new BigInt;var r=0;var i;for(var s=0;s<e.digits.length;++s){i=e.digits[s]+t.digits[s]+r;n.digits[s]=i&65535;r=Number(i>=biRadix)}n.isNeg=e.isNeg}return n}function biSubtract(e,t){var n;if(e.isNeg!=t.isNeg){t.isNeg=!t.isNeg;n=biAdd(e,t);t.isNeg=!t.isNeg}else{n=new BigInt;var r,i;i=0;for(var s=0;s<e.digits.length;++s){r=e.digits[s]-t.digits[s]+i;n.digits[s]=r&65535;if(n.digits[s]<0)n.digits[s]+=biRadix;i=0-Number(r<0)}if(i==-1){i=0;for(var s=0;s<e.digits.length;++s){r=0-n.digits[s]+i;n.digits[s]=r&65535;if(n.digits[s]<0)n.digits[s]+=biRadix;i=0-Number(r<0)}n.isNeg=!e.isNeg}else{n.isNeg=e.isNeg}}return n}function biHighIndex(e){var t=e.digits.length-1;while(t>0&&e.digits[t]==0)--t;return t}function biNumBits(e){var t=biHighIndex(e);var n=e.digits[t];var r=(t+1)*bitsPerDigit;var i;for(i=r;i>r-bitsPerDigit;--i){if((n&32768)!=0)break;n<<=1}return i}function biMultiply(e,t){var n=new BigInt;var r;var i=biHighIndex(e);var s=biHighIndex(t);var o,u,a;for(var f=0;f<=s;++f){r=0;a=f;for(j=0;j<=i;++j,++a){u=n.digits[a]+e.digits[j]*t.digits[f]+r;n.digits[a]=u&maxDigitVal;r=u>>>biRadixBits}n.digits[f+i+1]=r}n.isNeg=e.isNeg!=t.isNeg;return n}function biMultiplyDigit(e,t){var n,r,i;var s=new BigInt;n=biHighIndex(e);r=0;for(var o=0;o<=n;++o){i=s.digits[o]+e.digits[o]*t+r;s.digits[o]=i&maxDigitVal;r=i>>>biRadixBits}s.digits[1+n]=r;return s}function arrayCopy(e,t,n,r,i){var s=Math.min(t+i,e.length);for(var o=t,u=r;o<s;++o,++u){n[u]=e[o]}}function biShiftLeft(e,t){var n=Math.floor(t/bitsPerDigit);var r=new BigInt;arrayCopy(e.digits,0,r.digits,n,r.digits.length-n);var i=t%bitsPerDigit;var s=bitsPerDigit-i;for(var o=r.digits.length-1,u=o-1;o>0;--o,--u){r.digits[o]=r.digits[o]<<i&maxDigitVal|(r.digits[u]&highBitMasks[i])>>>s}r.digits[0]=r.digits[o]<<i&maxDigitVal;r.isNeg=e.isNeg;return r}function biShiftRight(e,t){var n=Math.floor(t/bitsPerDigit);var r=new BigInt;arrayCopy(e.digits,n,r.digits,0,e.digits.length-n);var i=t%bitsPerDigit;var s=bitsPerDigit-i;for(var o=0,u=o+1;o<r.digits.length-1;++o,++u){r.digits[o]=r.digits[o]>>>i|(r.digits[u]&lowBitMasks[i])<<s}r.digits[r.digits.length-1]>>>=i;r.isNeg=e.isNeg;return r}function biMultiplyByRadixPower(e,t){var n=new BigInt;arrayCopy(e.digits,0,n.digits,t,n.digits.length-t);return n}function biDivideByRadixPower(e,t){var n=new BigInt;arrayCopy(e.digits,t,n.digits,0,n.digits.length-t);return n}function biModuloByRadixPower(e,t){var n=new BigInt;arrayCopy(e.digits,0,n.digits,0,t);return n}function biCompare(e,t){if(e.isNeg!=t.isNeg){return 1-2*Number(e.isNeg)}for(var n=e.digits.length-1;n>=0;--n){if(e.digits[n]!=t.digits[n]){if(e.isNeg){return 1-2*Number(e.digits[n]>t.digits[n])}else{return 1-2*Number(e.digits[n]<t.digits[n])}}}return 0}function biDivideModulo(e,t){var n=biNumBits(e);var r=biNumBits(t);var i=t.isNeg;var s,o;if(n<r){if(e.isNeg){s=biCopy(bigOne);s.isNeg=!t.isNeg;e.isNeg=false;t.isNeg=false;o=biSubtract(t,e);e.isNeg=true;t.isNeg=i}else{s=new BigInt;o=biCopy(e)}return new Array(s,o)}s=new BigInt;o=e;var u=Math.ceil(r/bitsPerDigit)-1;var a=0;while(t.digits[u]<biHalfRadix){t=biShiftLeft(t,1);++a;++r;u=Math.ceil(r/bitsPerDigit)-1}o=biShiftLeft(o,a);n+=a;var f=Math.ceil(n/bitsPerDigit)-1;var l=biMultiplyByRadixPower(t,f-u);while(biCompare(o,l)!=-1){++s.digits[f-u];o=biSubtract(o,l)}for(var c=f;c>u;--c){var h=c>=o.digits.length?0:o.digits[c];var p=c-1>=o.digits.length?0:o.digits[c-1];var d=c-2>=o.digits.length?0:o.digits[c-2];var v=u>=t.digits.length?0:t.digits[u];var m=u-1>=t.digits.length?0:t.digits[u-1];if(h==v){s.digits[c-u-1]=maxDigitVal}else{s.digits[c-u-1]=Math.floor((h*biRadix+p)/v)}var g=s.digits[c-u-1]*(v*biRadix+m);var y=h*biRadixSquared+(p*biRadix+d);while(g>y){--s.digits[c-u-1];g=s.digits[c-u-1]*(v*biRadix|m);y=h*biRadix*biRadix+(p*biRadix+d)}l=biMultiplyByRadixPower(t,c-u-1);o=biSubtract(o,biMultiplyDigit(l,s.digits[c-u-1]));if(o.isNeg){o=biAdd(o,l);--s.digits[c-u-1]}}o=biShiftRight(o,a);s.isNeg=e.isNeg!=i;if(e.isNeg){if(i){s=biAdd(s,bigOne)}else{s=biSubtract(s,bigOne)}t=biShiftRight(t,a);o=biSubtract(t,o)}if(o.digits[0]==0&&biHighIndex(o)==0)o.isNeg=false;return new Array(s,o)}function biDivide(e,t){return biDivideModulo(e,t)[0]}function biModulo(e,t){return biDivideModulo(e,t)[1]}function biMultiplyMod(e,t,n){return biModulo(biMultiply(e,t),n)}function biPow(e,t){var n=bigOne;var r=e;while(true){if((t&1)!=0)n=biMultiply(n,r);t>>=1;if(t==0)break;r=biMultiply(r,r)}return n}function biPowMod(e,t,n){var r=bigOne;var i=e;var s=t;while(true){if((s.digits[0]&1)!=0)r=biMultiplyMod(r,i,n);s=biShiftRight(s,1);if(s.digits[0]==0&&biHighIndex(s)==0)break;i=biMultiplyMod(i,i,n)}return r}function BarrettMu(e){this.modulus=biCopy(e);this.k=biHighIndex(this.modulus)+1;var t=new BigInt;t.digits[2*this.k]=1;this.mu=biDivide(t,this.modulus);this.bkplus1=new BigInt;this.bkplus1.digits[this.k+1]=1;this.modulo=BarrettMu_modulo;this.multiplyMod=BarrettMu_multiplyMod;this.powMod=BarrettMu_powMod}function BarrettMu_modulo(e){var t=biDivideByRadixPower(e,this.k-1);var n=biMultiply(t,this.mu);var r=biDivideByRadixPower(n,this.k+1);var i=biModuloByRadixPower(e,this.k+1);var s=biMultiply(r,this.modulus);var o=biModuloByRadixPower(s,this.k+1);var u=biSubtract(i,o);if(u.isNeg){u=biAdd(u,this.bkplus1)}var a=biCompare(u,this.modulus)>=0;while(a){u=biSubtract(u,this.modulus);a=biCompare(u,this.modulus)>=0}return u}function BarrettMu_multiplyMod(e,t){var n=biMultiply(e,t);return this.modulo(n)}function BarrettMu_powMod(e,t){var n=new BigInt;n.digits[0]=1;while(true){if((t.digits[0]&1)!=0)n=this.multiplyMod(n,e);t=biShiftRight(t,1);if(t.digits[0]==0&&biHighIndex(t)==0)break;e=this.multiplyMod(e,e)}return n}(function(e){e.jCryption=function(t,n){var r=this;r.$el=e(t);r.el=t;r.$el.data("jCryption",r);r.init=function(){r.options=e.extend({},e.jCryption.defaultOptions,n);$encryptedElement=e("<input />",{type:"hidden",name:r.options.postVariable});if(r.options.submitElement!==false){var t=r.options.submitElement}else{var t=r.$el.find(":input:submit")}t.bind(r.options.submitEvent,function(){e(this).attr("disabled",true);if(r.options.beforeEncryption()){e.jCryption.getKeys(r.options.getKeysURL,function(t){e.jCryption.encrypt(r.$el.serialize(),t,function(t){$encryptedElement.val(t);e(r.$el).find(r.options.formFieldSelector).attr("disabled",true).end().append($encryptedElement).submit()})})}return false})};r.init()};e.jCryption.getKeys=function(t,n){var r=function(e,t,n){setMaxDigits(parseInt(n,10));this.e=biFromHex(e);this.m=biFromHex(t);this.chunkSize=2*biHighIndex(this.m);this.radix=16;this.barrett=new BarrettMu(this.m)};e.getJSON(t,function(t){var i=new r(t.e,t.n,t.maxdigits);if(e.isFunction(n)){n.call(this,i)}})};e.jCryption.encrypt=function(t,n,r){function c(t){function a(){o=new BigInt;s=0;for(var f=i;f<i+n.chunkSize;++s){o.digits[s]=t[f++];o.digits[s]+=t[f++]<<8}var l=n.barrett.powMod(o,n.e);var c=n.radix==16?biToHex(l):biToString(l,n.radix);u+=c+" ";i+=n.chunkSize;if(i<t.length){setTimeout(a,1)}else{var h=u.substring(0,u.length-1);if(e.isFunction(r)){r(h)}else{return h}}}var i=0;var s,o;var u="";setTimeout(a,1)}var i=0;for(var s=0;s<t.length;s++){i+=t.charCodeAt(s)}var o="0123456789abcdef";var u="";u+=o.charAt((i&240)>>4)+o.charAt(i&15);var a=u+t;var f=[];var l=0;while(l<a.length){f[l]=a.charCodeAt(l);l++}while(f.length%n.chunkSize!==0){f[l++]=0}c(f)};e.jCryption.defaultOptions={submitElement:false,submitEvent:"click",getKeysURL:"main.php?generateKeypair=true",beforeEncryption:function(){return true},postVariable:"jCryption",formFieldSelector:":input"};e.fn.jCryption=function(t){return this.each(function(){new e.jCryption(this,t)})}})(jQuery);var biRadixBase=2;var biRadixBits=16;var bitsPerDigit=biRadixBits;var biRadix=1<<16;var biHalfRadix=biRadix>>>1;var biRadixSquared=biRadix*biRadix;var maxDigitVal=biRadix-1;var maxInteger=9999999999999998;var maxDigits;var ZERO_ARRAY;var bigZero,bigOne;var dpl10=15;var highBitMasks=new Array(0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535);var hexatrigesimalToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z");var hexToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");var lowBitMasks=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535)